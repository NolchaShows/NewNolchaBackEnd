databases:
  - name: new-nolcha-postgres
    # Render no longer allows legacy Postgres plans (like `starter`) for new DBs.
    # Pick a current Postgres plan (adjust as needed in Render).
    plan: basic-256mb
    diskSizeGB: 5

services:
  - type: web
    name: new-nolcha-strapi
    runtime: node
    plan: starter
    buildCommand: npm ci && npm run build
    startCommand: npm run start
    healthCheckPath: /admin
    envVars:
      - key: NODE_ENV
        value: production
      - key: HOST
        value: 0.0.0.0
      - key: PROXY
        value: "true"

      - key: DATABASE_CLIENT
        value: postgres
      - key: DATABASE_URL
        fromDatabase:
          name: new-nolcha-postgres
          property: connectionString
      - key: DATABASE_SSL
        value: "true"
      - key: DATABASE_SSL_REJECT_UNAUTHORIZED
        value: "false"

      # Set this to your Render URL or custom domain, e.g. https://your-service.onrender.com
      - key: PUBLIC_URL
        sync: false

      # Cloudinary (required for media uploads)
      - key: CLOUDINARY_NAME
        sync: false
      - key: CLOUDINARY_KEY
        sync: false
      - key: CLOUDINARY_SECRET
        sync: false

      # Strapi secrets (generate securely in Render)
      - key: APP_KEYS
        generateValue: true
      - key: API_TOKEN_SALT
        generateValue: true
      - key: ADMIN_JWT_SECRET
        generateValue: true
      - key: TRANSFER_TOKEN_SALT
        generateValue: true
      - key: ENCRYPTION_KEY
        generateValue: true
      - key: JWT_SECRET
        generateValue: true

